<!-- Hero Section với slider và filter box -->
<div class="hero-section mb-5">
  <div class="row g-3 align-items-stretch">
    {{!-- LEFT: SLIDER --}}
    <div class="col-12 col-lg-8">
      <div class="card hero-slider-card border-0 overflow-hidden shadow-lg h-100">
        <div id="homeCarousel" class="carousel slide h-100" data-bs-ride="carousel">
          <div class="carousel-indicators">
            <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="0" class="active"></button>
            <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="1"></button>
            <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="2"></button>
          </div>

          <div class="carousel-inner h-100">
            {{#each slides}}
              <div class="carousel-item {{#if @first}}active{{/if}} h-100">
                <div class="position-relative h-100">
                  <img
                    src="{{img}}"
                    class="d-block w-100 h-100"
                    style="object-fit: cover;"
                    alt="{{title}}"
                  >
                  {{!-- Gradient overlay --}}
                  <div class="carousel-gradient-overlay"></div>
                  
                  {{!-- Carousel content --}}
                  <div class="carousel-caption-content">
                    <div class="container">
                      <div class="row align-items-center min-vh-80">
                        <div class="col-lg-6 text-start">
                          <h1 class="display-5 fw-bold text-white mb-3">{{title}}</h1>
                          <p class="lead text-white mb-4" style="opacity: 0.9;">{{desc}}</p>
                          <a href="/shop" class="btn btn-light btn-lg px-4 py-2 fw-semibold">Shop Now</a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            {{/each}}
          </div>

          <button class="carousel-control-prev" type="button" data-bs-target="#homeCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#homeCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
          </button>
        </div>
      </div>
    </div>

    {{!-- RIGHT: FILTER BOX --}}
    <div class="col-12 col-lg-4">
      <div class="card filter-card border-0 shadow-lg h-100">
        <div class="card-body p-4">
          {{!-- Header với badge --}}
          <div class="d-flex align-items-center justify-content-between mb-3">
            <h4 class="fw-bold mb-0 text-dark">
              <i class="bi bi-funnel me-2"></i>Quick Filter
            </h4>
            <span class="badge bg-dark rounded-pill px-3 py-2">HOME</span>
          </div>
          
          <p class="text-muted mb-4 small">
            Select category to filter products displayed on homepage.
          </p>

          {{!-- Filter form --}}
          <form method="get" action="/" class="vstack gap-3">
            <div>
              <label class="form-label fw-semibold mb-2">Category</label>
              <select class="form-select form-select-lg border-dark" name="category">
                <option value="">All Categories</option>
                {{#each categories}}
                  <option value="{{this}}" {{#ifEquals ../category this}}selected{{/ifEquals}}>
                    {{this}}
                  </option>
                {{/each}}
              </select>
            </div>

            <button class="btn btn-dark btn-lg w-100 py-2 fw-semibold">
              <i class="bi bi-search me-2"></i>View Results
            </button>

            {{#if category}}
              <a class="btn btn-outline-dark btn-lg w-100 py-2" href="/">
                <i class="bi bi-x-circle me-2"></i>Clear Filter
              </a>
            {{/if}}
          </form>

          <hr class="my-4">

          {{!-- Product count --}}
          <div class="d-flex justify-content-between align-items-center">
            <span class="text-muted">Displaying</span>
            <span class="fw-bold fs-5 text-dark">{{products.length}} products</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{{!-- Featured Products Section --}}
<section class="featured-products py-5">
  <div class="container-fluid">
    {{!-- Section Header --}}
    <div class="row align-items-center mb-4">
      <div class="col-md-8">
        <h2 class="display-6 fw-bold text-dark mb-2">Featured Products</h2>
        <p class="text-muted lead">Latest products with pagination.</p>
      </div>
      <div class="col-md-4 text-md-end">
        <a href="/products" class="btn btn-outline-dark btn-lg px-4">
          View All <i class="bi bi-arrow-right ms-2"></i>
        </a>
      </div>
    </div>

    {{!-- Products Grid --}}
    {{#if products.length}}
      <div class="row g-4">
        {{#each products}}
          <div class="col-12 col-md-6 col-lg-3">
            <div class="product-card card border-0 shadow-sm h-100 transition-all">
              {{!-- Product Image --}}
              <div class="product-image position-relative overflow-hidden">
                {{#if image}}
                  <img
                    src="{{image}}"
                    alt="{{name}}"
                    class="img-fluid w-100"
                    style="height: 250px; object-fit: cover;"
                  >
                {{else}}
                  <div class="bg-light d-flex align-items-center justify-content-center"
                       style="height: 250px;">
                    <span class="text-muted">No Image Available</span>
                  </div>
                {{/if}}
                
                {{!-- Quick actions --}}
                <div class="product-actions position-absolute top-0 end-0 p-2">
                  <button class="btn btn-light btn-sm rounded-circle shadow-sm">
                    <i class="bi bi-heart"></i>
                  </button>
                </div>
                
                {{!-- Category badge --}}
                <div class="position-absolute top-0 start-0">
                  <span class="badge bg-dark m-2">{{category}}</span>
                </div>
              </div>

              {{!-- Product Info --}}
              <div class="card-body p-3">
                <h5 class="card-title fw-bold mb-2 text-truncate">{{name}}</h5>
                <p class="card-text text-muted small mb-3" 
                   style="display: -webkit-box;
                          -webkit-line-clamp: 2;
                          -webkit-box-orient: vertical;
                          overflow: hidden;">
                  {{description}}
                </p>
                
                {{!-- Price and Stock --}}
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <div>
                    <span class="fs-4 fw-bold text-dark">${{price}}</span>
                  </div>
                  <div class="text-muted small">
                    <i class="bi bi-box-seam me-1"></i>{{stock}} in stock
                  </div>
                </div>
                
                {{!-- Action Button --}}
                <a href="/products/{{slug}}" class="btn btn-dark w-100">
                  <i class="bi bi-eye me-2"></i>View Details
                </a>
              </div>
            </div>
          </div>
        {{/each}}
      </div>

      {{!-- Pagination --}}
      <nav class="mt-5 pt-3 border-top">
        <ul class="pagination justify-content-center">
          {{#if hasPrev}}
            <li class="page-item">
              <a class="page-link btn-outline-dark" href="/?page={{prevPage}}&category={{category}}">
                <i class="bi bi-chevron-left me-2"></i>Previous
              </a>
            </li>
          {{else}}
            <li class="page-item disabled">
              <span class="page-link">
                <i class="bi bi-chevron-left me-2"></i>Previous
              </span>
            </li>
          {{/if}}

          <li class="page-item disabled">
            <span class="page-link bg-dark text-white fw-semibold">
              Page {{page}} of {{totalPages}}
            </span>
          </li>

          {{#if hasNext}}
            <li class="page-item">
              <a class="page-link btn-outline-dark" href="/?page={{nextPage}}&category={{category}}">
                Next <i class="bi bi-chevron-right ms-2"></i>
              </a>
            </li>
          {{else}}
            <li class="page-item disabled">
              <span class="page-link">
                Next <i class="bi bi-chevron-right ms-2"></i>
              </span>
            </li>
          {{/if}}
        </ul>
      </nav>
    {{else}}
      {{!-- Empty State --}}
      <div class="text-center py-5">
        <div class="mb-4">
          <i class="bi bi-box-seam display-1 text-muted"></i>
        </div>
        <h4 class="fw-bold text-dark mb-3">No Products Found</h4>
        <p class="text-muted mb-4">Try selecting a different category or check back later.</p>
        <a href="/" class="btn btn-dark btn-lg px-4">
          <i class="bi bi-arrow-clockwise me-2"></i>Clear Filters
        </a>
      </div>
    {{/if}}
  </div>
</section>

{{!-- Categories Banner --}}
<section class="categories-banner py-5 bg-light">
  <div class="container-fluid">
    <h3 class="fw-bold text-center mb-4">Shop By Category</h3>
    <div class="row g-3">
      {{#each categories}}
        <div class="col-6 col-md-4 col-lg-2">
          <a href="/?category={{this}}" class="text-decoration-none">
            <div class="category-card card border-0 text-center p-3 bg-white shadow-sm h-100 transition-all">
              <div class="mb-2">
                <i class="bi bi-tag display-6 text-dark"></i>
              </div>
              <h6 class="fw-semibold text-dark mb-0">{{this}}</h6>
            </div>
          </a>
        </div>
      {{/each}}
    </div>
  </div>
</section>

<style>
  /* Custom Styles */
  .hero-slider-card {
    border-radius: 16px;
  }
  
  .filter-card {
    border-radius: 16px;
    background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
  }
  
  .carousel-gradient-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 50%, rgba(0,0,0,0) 100%);
  }
  
  .carousel-caption-content {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
  }
  
  .product-card {
    border-radius: 12px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.15) !important;
  }
  
  .product-image {
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
  }
  
  .product-actions {
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  
  .product-card:hover .product-actions {
    opacity: 1;
  }
  
  .category-card {
    border-radius: 12px;
    transition: all 0.3s ease;
  }
  
  .category-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.1) !important;
    background-color: #f8f9fa !important;
  }
  
  .transition-all {
    transition: all 0.3s ease;
  }
  
  .min-vh-80 {
    min-height: 80vh;
  }
  
  .page-link.btn-outline-dark {
    border: 1px solid #dee2e6;
    color: #495057;
  }
  
  .page-link.btn-outline-dark:hover {
    background-color: #212529;
    color: white;
    border-color: #212529;
  }
</style>